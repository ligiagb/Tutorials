package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"strings"
)

// get URL Malware data - and compare for now
func MalwareURLs(url string) bool {
	ListOfurl := "https://zeustracker.abuse.ch/blocklist.php?download=compromised"
	trimmedurl := strings.TrimLeft(url, "/")
	resp, err := http.Get(ListOfurl)
	if err != nil {
		panic(err)
	}
	fmt.Printf("Response type: %T\n", resp)
	//defer resp.Body.Close()
	bytes, err := ioutil.ReadAll(resp.Body)
	if err != nil {
		panic(err)
	}
	URLsList := string(bytes)
	//	fmt.Printf("urlList : %s \n", URLsList)
	//	fmt.Printf("trimmedurl : %s\n", url)

	//	fmt.Println(strings.Contains(url, URLsList))
	return (strings.Contains(URLsList, trimmedurl))

}

/*
//list of badURLs
type Route struct {
	Pattern string
}
type Routes []Route

var routes = Routes{
	Route{"/Malwares"},
	Route{"/urlinfo/1/capacitacion.inami.gob.mx/capa.exe"},
	Route{"/Dontgothere"},
}
*/
